/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package DAO;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import intrfc.intrfcLogin;
import model.modelLogin;
import model.modelLogin;

/**
 *
 * @author BintangDiLangit
 */
public class loginDAO implements intrfcLogin{
     @Override
    public boolean sbgAdmin(String userid, String pass) {
       
        try {

            PreparedStatement statement = konek.koneksiDB().prepareStatement(
            "select userNameAdmn, pass from admin where userNameAdmn = ? and pass = ?");
            statement.setString(1, userid);
            statement.setString(2, pass);
            ResultSet result = statement.executeQuery();
            
            if (result.next()){
                modelLogin.setUserId(userid);
                modelLogin.setPass(pass);
                modelLogin.setPart("admin");
                modelLogin.setStatusLog("aktif");
                return true;      
            
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return false;
    }
    
     @Override
    public boolean sbgPentester(String userid, String pass) {
       
        try {

            PreparedStatement statement = konek.koneksiDB().prepareStatement(
            "select userNamePent, passPent from pentester where userNamePent = ? and passPent = ?");
            statement.setString(1, userid);
            statement.setString(2, pass);
            ResultSet result = statement.executeQuery();
            
            if (result.next()){
                modelLogin.setPart("pentester");
                return true;      
            
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return false;
    }
    
     @Override
    public boolean sbgPerusahaan(String email, String pass) {
       
        try {

            PreparedStatement statement = konek.koneksiDB().prepareStatement(
            "select emailPer, passPer from perusahaan where emailPer = ? and passPer = ?");
            statement.setString(1, email);
            statement.setString(2, pass);
            ResultSet result = statement.executeQuery();
            
            if (result.next()){
                modelLogin.setUserId(email);
                modelLogin.setPass(pass);
                modelLogin.setPart("perusahaan");
                modelLogin.setStatusLog("aktif");
                return true;      
            
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return false;
    }
}
